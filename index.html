<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Penalty Pro ‚Äî Keeper Learning (App UI)</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Roboto font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-1: #f5fbff;
      --card: #ffffff;
      --muted: #6b7c8a;
      --accent-1: #0ea5ff;
      --accent-2: #0077cc;
      --success: #06b6a4;
      --danger: #ef4444;
      --glass: rgba(14,165,255,0.06);
      --shadow-lg: 0 18px 48px rgba(2,10,23,0.08);
      --shadow-sm: 0 6px 20px rgba(2,10,23,0.06);
      --radius: 14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family: 'Roboto', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:linear-gradient(180deg,var(--bg-1), #eaf7ff); color:#05212b;}
    .app {
      max-width: 1100px;
      margin: 28px auto;
      padding: 20px;
    }

    /* Top header */
    .header {
      display:flex; align-items:center; gap:16px;
    }
    .brand {
      width:72px; height:72px; border-radius:12px; background:linear-gradient(135deg,var(--accent-2),var(--accent-1));
      display:flex; align-items:center; justify-content:center; font-weight:900; color:#021; font-size:20px; box-shadow:0 10px 36px rgba(14,165,255,0.12);
    }
    .title {
      display:flex; flex-direction:column;
    }
    .title h1{margin:0; font-size:20px;}
    .title p{margin:4px 0 0; color:var(--muted); font-size:13px}

    /* Layout */
    .layout { display:grid; grid-template-columns: 1fr 380px; gap:20px; margin-top:18px; }
    @media(max-width:1000px){ .layout{ grid-template-columns: 1fr; } .right{ order: 2; } .brand{width:56px;height:56px;} }

    /* Card */
    .card { background:var(--card); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow-lg); border:1px solid rgba(2,6,23,0.03); }
    .small { box-shadow:var(--shadow-sm); }

    /* Main action */
    .mainAction {
      display:flex; flex-direction:column; align-items:center; gap:12px;
    }
    .bigBtn {
      background: linear-gradient(90deg,var(--accent-2),var(--accent-1));
      color:#001827; padding:14px 28px; border-radius:12px; border:none; cursor:pointer; font-weight:900; font-size:16px;
      box-shadow:0 18px 44px rgba(14,165,255,0.12);
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .bigBtn:active{ transform: translateY(2px) scale(.998); }
    .hint { font-size:13px; color:var(--muted); text-align:center; }

    /* Prob tiles */
    .tiles { display:flex; gap:12px; margin-top:12px; }
    @media(max-width:640px){ .tiles{flex-direction:column;} }
    .tile {
      flex:1; background:linear-gradient(180deg, rgba(14,165,255,0.03), rgba(255,255,255,0.01));
      border-radius:12px; padding:12px; text-align:center; border:1px solid rgba(2,6,23,0.02);
      transform-origin:center; transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .tile .label { font-size:13px; color:var(--muted); }
    .tile .value { font-size:22px; font-weight:800; margin-top:6px; color:#042a3a; }
    .tile.highlight { transform: translateY(-6px); box-shadow: 0 14px 44px rgba(14,165,255,0.10); border-color: rgba(14,165,255,0.12); }

    /* Recommendation */
    .recommend {
      margin-top:12px; padding:12px; border-radius:10px; background:linear-gradient(90deg, rgba(6,182,212,0.12), rgba(14,165,255,0.06));
      font-weight:800; color:#021; text-align:center; font-size:15px;
      animation: popIn .36s ease both;
    }
    @keyframes popIn { from { opacity:0; transform: translateY(8px) scale(.98);} to { opacity:1; transform:none; } }
    .recommend .note { display:block; font-weight:600; margin-top:6px; color:var(--muted); font-size:13px; }

    /* Record buttons */
    .recordRow { display:flex; gap:10px; justify-content:center; margin-top:12px; flex-wrap:wrap; }
    .recBtn {
      padding:10px 12px; border-radius:10px; border:none; cursor:pointer; font-weight:700; color:var(--accent-2); background:#f3fbff;
      box-shadow:0 8px 20px rgba(14,165,255,0.06);
      transition: transform .08s ease;
    }
    .recBtn:active{ transform: translateY(2px); }
    .recBtn.danger { background:#fff5f5; color:var(--danger); box-shadow:0 8px 20px rgba(239,68,68,0.06); }

    /* Chart */
    .chartCard { margin-top:12px; padding:12px; border-radius:10px; background:linear-gradient(180deg,#fff,#fbfeff); border:1px solid rgba(2,6,23,0.03); }
    .chartWrap { position:relative; height:240px; }

    /* Reset area (separate) */
    .resetArea { margin-top:12px; display:flex; justify-content:center; }
    .resetBtn {
      background: linear-gradient(90deg,#ff9b9b,#ff6b6b); color:white; border:none; padding:10px 16px; border-radius:10px; cursor:pointer; font-weight:800;
      box-shadow:0 10px 28px rgba(255,107,107,0.12);
      transition: transform .12s ease;
    }
    .resetBtn:active{ transform: translateY(2px); }

    /* Right column details */
    .infoRow{ display:flex; justify-content:space-between; align-items:center; margin-top:8px; }
    .mutedSmall{ color:var(--muted); font-size:13px; }

    /* Logs */
    .logs { margin-top:10px; max-height:200px; overflow:auto; border-top:1px dashed rgba(2,6,23,0.03); padding-top:8px; color:var(--muted); font-size:13px; }

  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <div class="brand">S√öT</div>
      <div class="title">
        <h1>ƒêO√ÅN S√öT</h1>
        <p class="muted">S√öT V√ÄO CH·ªñ TH·ª¶ M√îN √çT CH·ª§P</p>
      </div>
    </div>

    <div class="layout">
      <!-- MAIN -->
      <div>
        <div class="card small">
          <div class="mainAction">
            <button id="btnPredict" class="bigBtn" aria-label="B·∫•m D·ª± ƒëo√°n ƒë·ªÉ nh·∫≠n g·ª£i √Ω">D·ª± ƒêo√°n</button>
            <div class="hint">Nh·∫•n D·ª∞ ƒêO√ÅN tr∆∞·ªõc khi s√∫t. Sau khi th·ªß m√¥n ch·ª•p, nh·∫•n n√∫t h∆∞·ªõng th·ªß m√¥n ƒë√£ bay ƒë·ªÉ h·ªá th·ªëng h·ªçc.</div>
          </div>

          <div class="tiles" id="tiles">
            <div class="tile" id="tile-left">
              <div class="label">Th·ªß m√¥n ch·ª•p TR√ÅI</div>
              <div class="value" id="val-left">33%</div>
            </div>
            <div class="tile" id="tile-mid">
              <div class="label">Th·ªß m√¥n ch·ª•p ‚Äî GI·ªÆA</div>
              <div class="value" id="val-mid">34%</div>
            </div>
            <div class="tile" id="tile-right">
              <div class="label">Th·ªß m√¥n ch·ª•p ‚Äî PH·∫¢I</div>
              <div class="value" id="val-right">33%</div>
            </div>
          </div>

          <div id="recommend" class="recommend" style="display:none">
            <div id="recText">G·ª£i √Ω: ‚Äî</div>
            <span class="note">H·ªá th·ªëng h·ªçc theo h∆∞·ªõng th·ªß m√¥n ch·ª•p</span>
          </div>

          <div class="recordRow">
            <button id="btnRecLeft" class="recBtn">Th·ªß m√¥n ch·ª•p ‚Äî Tr√°i</button>
            <button id="btnRecMid" class="recBtn">Th·ªß m√¥n ch·ª•p ‚Äî Gi·ªØa</button>
            <button id="btnRecRight" class="recBtn danger">Th·ªß m√¥n ch·ª•p ‚Äî Ph·∫£i</button>
          </div>

          <div class="chartCard">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <div style="font-weight:700">üìä L·ªãch s·ª≠ t·ªâ l·ªá th·ªß m√¥n ch·ª•p</div>
              <div class="mutedSmall">L∆∞·ª£t: <span id="countLabel">0</span></div>
            </div>
            <div class="chartWrap" style="margin-top:10px;">
              <canvas id="chart" aria-label="Bi·ªÉu ƒë·ªì l·ªãch s·ª≠"></canvas>
            </div>

            <div class="resetArea">
              <button id="btnReset" class="resetBtn" title="Reset d·ªØ li·ªáu (kh√¥ng h·ªèi)">üîÑ Reset</button>
            </div>

            <div class="logs" id="logs"></div>
          </div>
        </div>
      </div>

      <!-- RIGHT -->
      <div class="right">
        <div class="card small">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div style="font-weight:800">Tr·∫°ng th√°i m√¥ h√¨nh</div>
            <div class="mutedSmall">prior = 1</div>
          </div>

          <div style="margin-top:12px;" class="mutedSmall">Bayesian Œ± (keeper dived): <strong id="alphaVals">1 / 1 / 1</strong></div>
          <div style="margin-top:8px;" class="mutedSmall">Œ≤ (keeper not dived): <strong id="betaVals">1 / 1 / 1</strong></div>

          <div class="infoRow" style="margin-top:12px">
            <div class="mutedSmall">S·ªë v√≤ng m√¥ ph·ªèng</div>
            <input id="sims" type="number" min="100" step="100" value="1200" style="width:110px; padding:8px; border-radius:8px; border:1px solid rgba(2,6,23,0.04)">
          </div>

          <div style="margin-top:12px; display:flex; gap:8px;">
            <button id="btnExport" class="recBtn">Xu·∫•t JSON</button>
            <label class="recBtn" style="cursor:pointer">Nh·∫≠p JSON <input id="importFile" type="file" accept=".json" style="display:none"></label>
          </div>

          <div style="margin-top:12px; color:var(--muted); font-size:13px;">
            H∆∞·ªõng d·∫´n: 
			<p> B1: Nh·∫•n D·ª± ƒëo√°n. <p/>
			<p> B2: Sau khi th·ªß m√¥n ch·ª•p, ch·ªçn h∆∞·ªõng th·ªß m√¥n ƒë√£ bay. <p/>
			<p> B3: Ch·ªçn h∆∞·ªõng theo H·ªá th·ªëng khuy√™n s√∫t n∆°i th·ªß m√¥n √≠t ch·ª•p. <p/>
          </div>
        </div>
      </div>

    </div> <!-- layout -->
  </div> <!-- app -->

  <script>
  // =========================
  // Keeper-Learning App JS
  // - Thompson-sampling Monte Carlo
  // - Stores in localStorage
  // - Reset is immediate
  // =========================

  (function(){
    const LS_KEY = 'penalty_keeper_app_v1';

    // state
    let state = {
      alpha: [1,1,1], // keeper dived counts + prior
      beta:  [1,1,1], // keeper not dived counts + prior
      history: [], // {t,v}
      logs: []
    };

    // DOM
    const btnPredict = document.getElementById('btnPredict');
    const btnRecLeft = document.getElementById('btnRecLeft');
    const btnRecMid = document.getElementById('btnRecMid');
    const btnRecRight = document.getElementById('btnRecRight');
    const valLeft = document.getElementById('val-left');
    const valMid = document.getElementById('val-mid');
    const valRight = document.getElementById('val-right');
    const tileLeft = document.getElementById('tile-left');
    const tileMid = document.getElementById('tile-mid');
    const tileRight = document.getElementById('tile-right');
    const recommendBox = document.getElementById('recommend');
    const recText = document.getElementById('recText');
    const logsEl = document.getElementById('logs');
    const countLabel = document.getElementById('countLabel');
    const alphaVals = document.getElementById('alphaVals');
    const betaVals = document.getElementById('betaVals');
    const simsInput = document.getElementById('sims');
    const btnReset = document.getElementById('btnReset');
    const btnExport = document.getElementById('btnExport');
    const importFile = document.getElementById('importFile');

    // RNG + samplers
    function xfnv1a(str) {
      let h = 2166136261 >>> 0;
      for (let i = 0; i < str.length; i++) {
        h ^= str.charCodeAt(i);
        h = Math.imul(h, 16777619);
      }
      return function() {
        h += h << 13; h ^= h >>> 7; h += h << 3; h ^= h >>> 17; h += h << 5;
        return h >>> 0;
      };
    }
    function mulberry32(a) {
      return function() {
        let t = (a += 0x6D2B79F5);
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }
    function makeRng(seed) {
      if(!seed) return Math.random;
      const sfn = xfnv1a(seed);
      const s = sfn();
      return mulberry32(s);
    }

    function sampleGamma(rng, k) {
      if (k < 1) {
        const u = rng();
        return sampleGamma(rng, k + 1) * Math.pow(u, 1 / k);
      }
      const d = k - 1/3;
      const c = 1 / Math.sqrt(9 * d);
      for(let iter=0; iter<5000; iter++){
        let x, v;
        do {
          const u1 = rng(), u2 = rng();
          const z = Math.sqrt(-2 * Math.log(Math.max(u1,1e-12))) * Math.cos(2*Math.PI*u2);
          x = z; v = 1 + c*x;
        } while(v <= 0);
        v = v*v*v;
        const u = rng();
        if (u < 1 - 0.0331*(x*x)*(x*x)) return d*v;
        if (Math.log(u) < 0.5*x*x + d*(1 - v + Math.log(v))) return d*v;
      }
      return Math.max(1e-3, d);
    }
    function sampleBeta(rng, a, b) {
      try {
        const x = sampleGamma(rng, a);
        const y = sampleGamma(rng, b);
        if (x + y === 0) return 0.5;
        return x / (x + y);
      } catch(e) {
        console.warn('sampleBeta fallback', e);
        return 0.5;
      }
    }

    // prediction (keeper dive probability)
    function predictKeeper({sims=1200, seed=''} = {}) {
      try {
        const rng = makeRng(seed || String(Math.random()));
        const wins = [0,0,0];
        for(let i=0;i<sims;i++){
          const d0 = sampleBeta(rng, Math.max(0.1, state.alpha[0]), Math.max(0.1, state.beta[0]));
          const d1 = sampleBeta(rng, Math.max(0.1, state.alpha[1]), Math.max(0.1, state.beta[1]));
          const d2 = sampleBeta(rng, Math.max(0.1, state.alpha[2]), Math.max(0.1, state.beta[2]));
          const arr = [d0,d1,d2];
          let m = 0; for(let j=1;j<3;j++) if(arr[j] > arr[m]) m=j;
          wins[m] += 1;
        }
        const total = wins[0] + wins[1] + wins[2] || 1;
        return wins.map(w => w/total);
      } catch(e) {
        console.error('predictKeeper error', e);
        const means = state.alpha.map((a,i)=> a/(a+state.beta[i]));
        const s = means.reduce((a,b)=>a+b,0) || 1;
        return means.map(m=> m/s);
      }
    }

    // chart
    let chart = null;
    function initChart(){
      try {
        const ctx = document.getElementById('chart').getContext('2d');
        chart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: [],
            datasets: [
              { label:'Tr√°i %', data:[], borderColor:'rgba(14,165,255,0.95)', backgroundColor:'rgba(14,165,255,0.12)', fill:true, tension:0.22 },
              { label:'Gi·ªØa %', data:[], borderColor:'rgba(6,182,212,0.95)', backgroundColor:'rgba(6,182,212,0.12)', fill:true, tension:0.22 },
              { label:'Ph·∫£i %', data:[], borderColor:'rgba(16,185,129,0.95)', backgroundColor:'rgba(16,185,129,0.12)', fill:true, tension:0.22 }
            ]
          },
          options: {
            responsive:true, maintainAspectRatio:false,
            animation: { duration: 600 },
            scales: { y: { beginAtZero:true, max:100 } }
          }
        });
      } catch(e){ console.warn('Chart init', e); chart = null; }
    }

    function pushChartPoint(p){
      if(!chart) return;
      chart.data.labels.push(chart.data.labels.length + 1);
      chart.data.datasets[0].data.push(Number((p[0]*100).toFixed(2)));
      chart.data.datasets[1].data.push(Number((p[1]*100).toFixed(2)));
      chart.data.datasets[2].data.push(Number((p[2]*100).toFixed(2)));
      if(chart.data.labels.length > 300){
        chart.data.labels.shift();
        chart.data.datasets.forEach(ds => ds.data.shift());
      }
      chart.update();
      countLabel.innerText = chart.data.labels.length;
    }

    // logs
    function appendLog(txt){
      state.logs.push({t:Date.now(), txt});
      if(state.logs.length > 800) state.logs.shift();
      renderLogs();
      save();
    }
    function renderLogs(){
      logsEl.innerHTML = '';
      const arr = state.logs.slice().reverse();
      for(const it of arr){
        const row = document.createElement('div');
        row.style.display='flex'; row.style.justifyContent='space-between'; row.style.padding='8px 6px'; row.style.borderBottom='1px solid rgba(2,6,23,0.01)';
        const left = document.createElement('div'); left.innerText = new Date(it.t).toLocaleTimeString();
        const right = document.createElement('div'); right.innerText = it.txt; right.style.color = 'var(--muted)';
        row.appendChild(left); row.appendChild(right); logsEl.appendChild(row);
      }
    }

    // UI update
    function updateModelView(){
      alphaVals.innerText = `${state.alpha[0].toFixed(1)} / ${state.alpha[1].toFixed(1)} / ${state.alpha[2].toFixed(1)}`;
      betaVals.innerText = `${state.beta[0].toFixed(1)} / ${state.beta[1].toFixed(1)} / ${state.beta[2].toFixed(1)}`;
    }

    // predict action
    async function handlePredict(){
      btnPredict.disabled = true; btnPredict.innerText = 'ƒêang d·ª± ƒëo√°n...';
      try {
        const sims = Math.max(200, Number(simsInput.value) || 1200);
        await new Promise(r=>setTimeout(r, 20));
        const probs = predictKeeper({sims});
        const p0 = probs[0]*100, p1 = probs[1]*100, p2 = probs[2]*100;
        // set tiles
        valLeft.innerText = p0.toFixed(1) + '%';
        valMid.innerText = p1.toFixed(1) + '%';
        valRight.innerText = p2.toFixed(1) + '%';
        // highlight most likely dive (keeper)
        const most = probs.indexOf(Math.max(...probs));
        [tileLeft,tileMid,tileRight].forEach((el,i)=> el.classList.toggle('highlight', i===most));
        // suggest shoot where keeper least likely
        const least = probs.indexOf(Math.min(...probs));
        recText.innerText = `G·ª£i √Ω: S√∫t v√†o ${['Tr√°i','Gi·ªØa','Ph·∫£i'][least]} (th·ªß m√¥n √≠t ch·ª•p)`;
        recommendBox.style.display = 'block';
        // animate the recommendation briefly
        recommendBox.animate([{ transform: 'scale(0.98)', opacity:0 }, { transform:'scale(1)', opacity:1 }], { duration: 320, easing:'ease' });
        // push chart & log
        pushChartPoint(probs);
        appendLog(`PREDICT ‚Üí L:${p0.toFixed(1)}% M:${p1.toFixed(1)}% R:${p2.toFixed(1)}% ‚Ä¢ suggest ${['Tr√°i','Gi·ªØa','Ph·∫£i'][least]}`);
      } catch(e){
        console.error('predict error', e);
        appendLog('ERROR during predict');
      } finally {
        btnPredict.disabled = false; btnPredict.innerText = 'B·∫•m D·ª± ƒëo√°n ƒë·ªÉ nh·∫≠n g·ª£i √Ω';
        updateModelView();
        save();
      }
    }

    // record keeper dive (user clicks the side that keeper dived)
    function recordDive(idx){
      for(let i=0;i<3;i++){
        if(i===idx) state.alpha[i] += 1; else state.beta[i] += 1;
      }
      state.history.push({t:Date.now(), v: idx});
      if(state.history.length > 4000) state.history.shift();
      appendLog(`RECORD ‚Üí keeper dived ${['Tr√°i','Gi·ªØa','Ph·∫£i'][idx]}`);
      updateModelView();
      save();
      // quick update of displayed probabilities (small sims)
      try { const quick = predictKeeper({sims:300}); valLeft.innerText = (quick[0]*100).toFixed(1)+'%'; valMid.innerText = (quick[1]*100).toFixed(1)+'%'; valRight.innerText = (quick[2]*100).toFixed(1)+'%'; } catch(e){}
    }

    // reset immediate
    function doReset(){
      state = { alpha:[1,1,1], beta:[1,1,1], history:[], logs:[] };
      // clear UI
      valLeft.innerText = '33%'; valMid.innerText='34%'; valRight.innerText='33%';
      recommendBox.style.display = 'none';
      if(chart){ chart.data.labels = []; chart.data.datasets.forEach(ds=> ds.data = []); chart.update(); countLabel.innerText = 0; }
      renderLogs();
      updateModelView();
      save();
    }

    // export / import
    function doExport(){
      try {
        const blob = new Blob([JSON.stringify(state, null, 2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'keeper_state.json'; a.click(); URL.revokeObjectURL(url);
      } catch(e){ alert('Xu·∫•t th·∫•t b·∫°i'); }
    }
    function doImport(file){
      const reader = new FileReader();
      reader.onload = ()=> {
        try {
          const s = JSON.parse(reader.result);
          state = Object.assign(state, s);
          state.alpha = state.alpha || [1,1,1]; state.beta = state.beta || [1,1,1];
          state.history = state.history || []; state.logs = state.logs || [];
          appendLog('IMPORTED state JSON');
          updateModelView(); renderLogs(); save();
        } catch(e){ alert('T·ªáp JSON kh√¥ng h·ª£p l·ªá'); }
      };
      reader.readAsText(file);
    }

    // persistence
    function load(){
      try {
        const raw = localStorage.getItem(LS_KEY);
        if(raw){
          const s = JSON.parse(raw); state = Object.assign(state, s);
          state.alpha = state.alpha || [1,1,1]; state.beta = state.beta || [1,1,1];
          state.history = state.history || []; state.logs = state.logs || [];
        }
      } catch(e){ console.warn('load', e); }
    }
    function save(){
      try { localStorage.setItem(LS_KEY, JSON.stringify(state)); } catch(e){ console.warn('save', e); }
    }

    // render logs & model view on load
    function renderAll(){
      renderLogs(); updateModelView();
      // warm-up chart from history
      try {
        if(state.history && state.history.length){
          const L = Math.min(60, state.history.length);
          const tmpA = [1,1,1], tmpB = [1,1,1];
          for(let i=Math.max(0, state.history.length - L); i<state.history.length; i++){
            const v = state.history[i].v;
            for(let k=0;k<3;k++){ if(k===v) tmpA[k]+=1; else tmpB[k]+=1; }
            const m = [ tmpA[0]/(tmpA[0]+tmpB[0]), tmpA[1]/(tmpA[1]+tmpB[1]), tmpA[2]/(tmpA[2]+tmpB[2]) ];
            pushChartPoint(m);
          }
        }
      } catch(e){ console.warn('warmup', e); }
    }

    // wiring UI
    btnPredict.addEventListener('click', handlePredict);
    btnRecLeft.addEventListener('click', ()=> recordDive(0));
    btnRecMid.addEventListener('click', ()=> recordDive(1));
    btnRecRight.addEventListener('click', ()=> recordDive(2));
    btnReset.addEventListener('click', doReset);
    btnExport.addEventListener('click', doExport);
    importFile.addEventListener('change', (ev)=> { const f = ev.target.files[0]; if(f) doImport(f); });

    // startup
    load();
    initChart();
    renderAll();
    updateModelView();
    // set initial tile values from means
    try {
      const m = state.alpha.map((a,i)=> a/(a+state.beta[i])); const s = m.reduce((a,b)=>a+b,0)||1; const probs=[m[0]/s,m[1]/s,m[2]/s];
      valLeft.innerText=(probs[0]*100).toFixed(1)+'%'; valMid.innerText=(probs[1]*100).toFixed(1)+'%'; valRight.innerText=(probs[2]*100).toFixed(1)+'%';
    } catch(e){}
    // expose for debug
    window._penaltyKeeperState = state;

  })();

  </script>
</body>
</html>
